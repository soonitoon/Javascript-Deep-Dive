# 13장: 스코프

## 13.1 스코프란?

- **스코프**란 식별자가 유효한 범위다.
- 모든 식별자는 자신이 선언된 위치에 의해 스코프가 결정된다.

```javascript
const a = 1;

function f() {
  const b = 2;
  console.log(b) // 2
}

console.log(a) // 1
console.log(b) // Uncaught ReferenceError: b is not defined
```

- 스코프라는 개념이 없다면 식별자를 만들기 매우 까다로워질 것이다. 변수명 같은 식별자는 유일해야 하기 때문이다.
- 이름이 같지만 스코프가 다른 두 변수가 존재할 수 있다.

```javascript
const a = 1;

console.log(a); // 1

if (true) {
  const a = 2;
  console.log(a); // 2
}
```

- 이러한 경우 첫 번째 로그는 전역 변수 a를 참조한다는 것이 분명하지만 두 번째 로그의 경우 전역 변수 a를 참조해야 하는지, 지역 변수 a를 참조해야 하는지 불분명하다.
- 이렇게 이름이 같은 변수 중 어느 것을 참조해야 할지 결정하는 것을 **식별자 결정**이라고 한다.
- 자바스크립트 엔진은 코드를 실행할 때 코드의 **문맥**을 함께 고려하며, 이에 따라 적절한 변수를 참조한다.

## 13.2 스코프의 종류

- 스코프는 **전역 스코프**와 **지역 스코프**로 나뉜다.
  - 전역 스코프는 코드의 가장 바깥 영역에서 생성된 변수가 같는다.
  - 지역 스코프는 함수 몸체 내에서 생성된 변수가 갖는다.
- 지역 변수는 어디에서든지 참조할 수 있다.

### 13.2.2 지역과 지역 스코프

- 지역 변수는 자신이 생성된 지역 스코프와 하위 스코프에서만 참조할 수 있다.
- 지역 변수와 같은 이름의 전역 변수가 있는 상황에서 지역 변수를 해당 변수가 생성된 지역에서 참조하면 전역 변수가 아니라 항상지역 변수를 참조한다.
- 이는 **스코프 체인** 개념과 관련있다.

## 13.3 스코프 체인

- 함수 안에 다른 함수를 중첩해서 선언할 수 있다.
- 따라서 스코프 역시 중첩될 수 있고, 계층적 구조를 갖는다.
  - 중첩 함수 스코프의 상위 스코프는 외부 함수의 스코프다.
  - 외부 함수 스코프의 상위 스코프는 전역 스코프다.
  - 이런 방식으로 모든 스코프는 하나의 계층 구조로 연결되며 이를 **스코프 체인**이라고 한다.
- 자바스크립트 엔진은 변수를 참조할 때 변수를 참조하는 현재 위치에서 시작해 스코프 체인의 상위 방향으로 이동하며 변수를 검색한다.
  - 이렇듯 변수의 검색 방향이 하위에서 상위로 가기 때문에 상위 스코프와 하위 스코프에 이름이 같은 변수가 있다면 언제나 하위 스코프의 변수가 참조된다.